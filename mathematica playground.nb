(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27560,        744]
NotebookOptionsPosition[     26009,        711]
NotebookOutlinePosition[     26418,        727]
CellTagsIndexPosition[     26375,        724]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Ratio change:", "Section",
 CellChangeTimes->{{3.910265517191603*^9, 
  3.91026553899358*^9}},ExpressionUUID->"d0570329-f513-4c93-979d-\
6f0ffa0106ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"before", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"after", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"v", "/", "y"}], "+", 
     RowBox[{"u", "/", "x"}]}], ")"}], "*", 
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "-", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"after", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", "before"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotPoints", "->", "100"}], ",", "\[IndentingNewLine]", 
   RowBox[{"MeshFunctions", "->", 
    RowBox[{"{", 
     RowBox[{"#3", "&"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Mesh", "->", "3"}], ",", 
   RowBox[{"MeshStyle", "->", 
    RowBox[{"{", 
     RowBox[{"Black", ",", 
      RowBox[{"Thickness", "[", "0.003", "]"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ClippingStyle", "->", "None"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotStyle", "->", 
    RowBox[{"Opacity", "[", "0.75", "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQLbDpX8Fs+beO19U2FYHoHVdPW3wD0nP9DtiA6JYp
rx1B9G6/lS4gWmRzay6IXn+lKw9Em9wQFfgOpFd3dYDpM5eW+YBoE61wXxB9
UEbg6RnFt44nls7+B6LP6zUxnwXSTuftFUH0QtlnWiBaTvANmFZxfGAAokVu
9YSAaOebepEgum+fdjSI7r/+NxFEM09gSgLRv1PmpYPo4iyeXBC9pPFGKYhW
KlhZD6JDmhNbQXRwdjqYfrCmvBNEn9mR1Auiv/GmbAfRbe8mHQTRWl+VTWyV
3jquSnxuCqKXF9e5gOiwSc1g2uBh6+Ri5beOQryfl4FoAKD5oac=
  "],
 CellLabel->"In[45]:=",ExpressionUUID->"4bcda9e4-6467-463a-8545-a5cfc9ee08d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"perpTo", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], ",", " ", "val0_"}], "]"}], 
  ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "*", "x"}], "+", 
       RowBox[{"b", "*", "y"}]}], ")"}]}], "/", "c"}], "+", 
   "val0"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"perpTo", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "2"}], ",", "5"}], "}"}], ",", "0.1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"perpTo", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "0", ",", "5"}], "}"}], ",", "0.1"}], 
      "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotPoints", "->", "100"}], ",", "\[IndentingNewLine]", 
   RowBox[{"MeshFunctions", "->", 
    RowBox[{"{", 
     RowBox[{"#3", "&"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"ClippingStyle", "->", "None"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.910119213781287*^9, 3.910119234889958*^9}, {
  3.9101192775716734`*^9, 3.910119341148595*^9}, {3.9101194677346964`*^9, 
  3.910119516079711*^9}, {3.9102654442397795`*^9, 3.910265445044629*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"2a7cb272-9e45-4350-ad9e-e4f54443b43d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regions functions", "Section",
 CellChangeTimes->{{3.910265543806525*^9, 
  3.910265554489962*^9}},ExpressionUUID->"0ae9112f-6515-4c78-a437-\
fb960f71a99b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", "0.4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PositiveSlope", "[", 
    RowBox[{"u_", ",", "v_", ",", "x_", ",", "y_", ",", "w_", ",", "h_"}], 
    "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "h"}], ",", "w"}], "}"}], ".", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"h", "*", "x"}], "-", 
      RowBox[{"w", "*", "y"}]}], ")"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NegativeSlope", "[", 
    RowBox[{"u_", ",", "v_", ",", "x_", ",", "y_", ",", "w_", ",", "h_"}], 
    "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h", ",", "w"}], "}"}], ".", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}]}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "h"}], "*", "w"}], "-", 
      RowBox[{"h", "*", "x"}], "-", 
      RowBox[{"w", "*", "y"}]}], " ", ")"}]}]}], ";"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"dec1aa7e-e3be-4d19-83ce-bd56c4266058"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RegionPlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"PositiveSlope", "[", 
            RowBox[{"u", ",", "v", ",", "x", ",", "y", ",", "w", ",", "h"}], 
            "]"}], ">", "0"}], "&&", " ", 
          RowBox[{
           RowBox[{"NegativeSlope", "[", 
            RowBox[{"u", ",", "v", ",", "x", ",", "y", ",", "w", ",", "h"}], 
            "]"}], ">", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"PositiveSlope", "[", 
            RowBox[{"u", ",", "v", ",", "x", ",", "y", ",", "w", ",", "h"}], 
            "]"}], "<", "0"}], "&&", " ", 
          RowBox[{
           RowBox[{"NegativeSlope", "[", 
            RowBox[{"u", ",", "v", ",", "x", ",", "y", ",", "w", ",", "h"}], 
            "]"}], "<", "0"}]}]}], "}"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"PlotPoints", "->", "60"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FaceForm", "[", 
          RowBox[{"Opacity", "[", "0", "]"}], "]"}], ",", 
         RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
         RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "+", "w"}], ",", 
             RowBox[{"y", "+", "h"}]}], "}"}]}], "]"}]}], "}"}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
   ",", 
   RowBox[{"Axes", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9102656036585035`*^9, 3.910265624310497*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"ba8dc4c8-c204-4cfc-b176-6eb29dab542f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CDF for family of disjoint rectangles", "Section",
 CellChangeTimes->{{3.9108238524956365`*^9, 
  3.9108238870594645`*^9}},ExpressionUUID->"59891bc8-92a3-45ca-9929-\
6acc3a769e01"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rect", "[", 
    RowBox[{"x_", ",", "y_", ",", "rx_", ",", "ry_", ",", "rw_", ",", "rh_"}],
     "]"}], ":=", 
   RowBox[{"Piecewise", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"x", "<=", "rx"}], "||", 
         RowBox[{"y", "<=", "ry"}]}]}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rw", "*", "rh"}], ",", 
        RowBox[{
         RowBox[{"x", ">=", 
          RowBox[{"rx", "+", "rw"}]}], "&&", 
         RowBox[{"y", ">=", 
          RowBox[{"ry", "+", "rh"}]}]}]}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", "rx"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"y", "-", "ry"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"rx", "<", "x", "<", 
          RowBox[{"rx", "+", "rw"}]}], "&&", 
         RowBox[{"ry", "<", "y", "<", 
          RowBox[{"ry", "+", "rh"}]}]}]}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", "rx"}], ")"}], "*", "rh"}], ",", 
        RowBox[{
         RowBox[{"rx", "<", "x", "<", 
          RowBox[{"rx", "+", "rw"}]}], " ", "&&", 
         RowBox[{
          RowBox[{"ry", "+", "rh"}], "<=", "y"}]}]}], " ", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y", "-", "ry"}], ")"}], "*", "rw"}], ",", 
        RowBox[{
         RowBox[{"ry", "<", "y", "<", 
          RowBox[{"ry", "+", "rh"}]}], " ", "&&", 
         RowBox[{
          RowBox[{"rx", "+", "rw"}], "<=", "x"}]}]}], " ", "}"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9108238957244053`*^9, 3.910823973255615*^9}, {
   3.9108240271493673`*^9, 3.9108240497914677`*^9}, {3.9108241441145306`*^9, 
   3.910824267922471*^9}, {3.910825193686016*^9, 3.910825319601943*^9}, {
   3.910825393145133*^9, 3.9108255405260363`*^9}, {3.9108256087283754`*^9, 
   3.9108256864219875`*^9}, {3.9108257540010138`*^9, 
   3.9108258168629436`*^9}, {3.910826038985867*^9, 3.9108260516458187`*^9}, {
   3.910826082245143*^9, 3.910826098316867*^9}, {3.91082613547484*^9, 
   3.910826161735421*^9}, {3.910826207513706*^9, 3.9108262238076673`*^9}, {
   3.910826276890343*^9, 3.9108262780136585`*^9}, {3.9108264469407277`*^9, 
   3.9108264500157776`*^9}, {3.910826481283616*^9, 3.9108264971807103`*^9}, {
   3.9108265933847256`*^9, 3.9108266803482113`*^9}, {3.9108267177894397`*^9, 
   3.910826718444687*^9}, {3.9108268326815977`*^9, 3.910826850984455*^9}, {
   3.910827147845501*^9, 3.9108272492193217`*^9}, {3.910827643946371*^9, 
   3.9108276710613594`*^9}, {3.910828683269968*^9, 3.9108287081866827`*^9}, 
   3.9108287582582006`*^9, {3.910828803965926*^9, 3.9108288091059294`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"3a135901-17f9-40f4-868b-80536c8495c7"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"(*", 
     RowBox[{"rect", "[", 
      RowBox[{"x", ",", "y", ",", "0.2", ",", "0.3", ",", "0.5", ",", "0.4"}],
       "]"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "*", "y"}], "-", "\[IndentingNewLine]", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"rect", "[", 
          RowBox[{
          "x", ",", "y", ",", "0.2", ",", "0.3", ",", "0.3", ",", "0.2"}], 
          "]"}], "+", "\[IndentingNewLine]", 
         RowBox[{"rect", "[", 
          RowBox[{
          "x", ",", "y", ",", "0.6", ",", "0.1", ",", "0.2", ",", "0.4"}], 
          "]"}], "+", "\[IndentingNewLine]", 
         RowBox[{"rect", "[", 
          RowBox[{
          "x", ",", "y", ",", "0.1", ",", "0.9", ",", "0.85", ",", "0.05"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", ")"}], "/", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"0.3", "*", "0.2"}], "-", 
       RowBox[{"0.2", "*", "0.4"}], "-", 
       RowBox[{"0.85", "*", "0.05"}]}], ")"}]}], "\[IndentingNewLine]", "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotPoints", "->", "50"}], ",", 
   RowBox[{"ExclusionsStyle", "->", 
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "Black"}], "}"}]}], ",", 
   RowBox[{"MeshFunctions", "->", 
    RowBox[{"{", 
     RowBox[{"#3", "&"}], "}"}]}], ",", 
   RowBox[{"Mesh", "->", "20"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9108288125066776`*^9, 3.910828906877757*^9}, {
  3.910828955737192*^9, 3.91082910334652*^9}, {3.910830775169304*^9, 
  3.9108307775004034`*^9}, {3.9108840761843853`*^9, 3.9108841384493833`*^9}, {
  3.9108842512623014`*^9, 3.9108842548313007`*^9}, {3.9108842910132785`*^9, 
  3.9108842958031235`*^9}, {3.910884369798232*^9, 3.9108843883330417`*^9}, {
  3.9108844484325633`*^9, 3.9108844568041306`*^9}, {3.9108845106161366`*^9, 
  3.9108845362641172`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"6e635659-aa74-440f-a8f5-81aa9fe161d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "*", "y"}], "-", "\[IndentingNewLine]", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"rect", "[", 
         RowBox[{
         "x", ",", "y", ",", "0.2", ",", "0.3", ",", "0.3", ",", "0.2"}], 
         "]"}], "+", "\[IndentingNewLine]", 
        RowBox[{"rect", "[", 
         RowBox[{
         "x", ",", "y", ",", "0.6", ",", "0.1", ",", "0.2", ",", "0.4"}], 
         "]"}], "+", "\[IndentingNewLine]", 
        RowBox[{"rect", "[", 
         RowBox[{
         "x", ",", "y", ",", "0.1", ",", "0.9", ",", "0.85", ",", "0.05"}], 
         "]"}]}], ")"}]}], "\[IndentingNewLine]", ")"}], "/", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"0.3", "*", "0.2"}], "-", 
      RowBox[{"0.2", "*", "0.4"}], "-", 
      RowBox[{"0.85", "*", "0.05"}]}], ")"}]}], ",", "x", ",", "y"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9108292444775267`*^9, 3.910829346556425*^9}, {
   3.9108294352363405`*^9, 3.9108294361749387`*^9}, 3.9108307384846725`*^9, 
   3.910830793990116*^9},
 CellLabel->
  "In[102]:=",ExpressionUUID->"ccc8bfa3-939b-49c5-a5d9-55208fb57b4e"],

Cell[BoxData[
 RowBox[{"1.2232415902140674`", " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"(", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {"0", 
            RowBox[{
             RowBox[{"0.1`", "<", "x", "<", "0.95`"}], "&&", 
             RowBox[{"y", "\[GreaterEqual]", "0.95`"}]}]},
           {"1", 
            RowBox[{
             RowBox[{"0.1`", "<", "x", "<", "0.95`"}], "&&", 
             RowBox[{"0.9`", "<", "y", "<", "0.95`"}]}]},
           {"0", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}},
          Selectable->True]}
       },
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False,
      StripWrapperBoxes->True], ")"}], "-", 
    RowBox[{"(", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {"0", 
            RowBox[{
             RowBox[{"0.2`", "<", "x", "<", "0.5`"}], "&&", 
             RowBox[{"y", "\[GreaterEqual]", "0.5`"}]}]},
           {"1", 
            RowBox[{
             RowBox[{"0.2`", "<", "x", "<", "0.5`"}], "&&", 
             RowBox[{"0.3`", "<", "y", "<", "0.5`"}]}]},
           {"0", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}},
          Selectable->True]}
       },
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False,
      StripWrapperBoxes->True], ")"}], "-", 
    RowBox[{"(", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {"0", 
            RowBox[{
             RowBox[{"0.6`", "<", "x", "<", "0.8`"}], "&&", 
             RowBox[{"y", "\[GreaterEqual]", "0.5`"}]}]},
           {"1", 
            RowBox[{
             RowBox[{"0.6`", "<", "x", "<", "0.8`"}], "&&", 
             RowBox[{"0.1`", "<", "y", "<", "0.5`"}]}]},
           {"0", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}},
          Selectable->True]}
       },
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False,
      StripWrapperBoxes->True], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.910829437084699*^9, 3.910830743821687*^9, 
  3.9108307958402214`*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"a987a9e8-3f44-4063-bab2-ee50fc304aa7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{"1.2232415902140674`", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       TagBox[GridBox[{
          {"\[Piecewise]", GridBox[{
             {"0", 
              RowBox[{
               RowBox[{"0.1`", "<", "x", "<", "0.95`"}], "&&", 
               RowBox[{"y", "\[GreaterEqual]", "0.95`"}]}]},
             {"1", 
              RowBox[{
               RowBox[{"0.1`", "<", "x", "<", "0.95`"}], "&&", 
               RowBox[{"0.9`", "<", "y", "<", "0.95`"}]}]},
             {"0", 
              TagBox["True",
               "PiecewiseDefault",
               AutoDelete->True]}
            },
            AllowedDimensions->{2, Automatic},
            Editable->True,
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}},
            Selectable->True]}
         },
         GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
         GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.35]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        "Piecewise",
        DeleteWithContents->True,
        Editable->False,
        SelectWithContents->True,
        Selectable->False,
        StripWrapperBoxes->True], ")"}], "-", 
      RowBox[{"(", 
       TagBox[GridBox[{
          {"\[Piecewise]", GridBox[{
             {"0", 
              RowBox[{
               RowBox[{"0.2`", "<", "x", "<", "0.5`"}], "&&", 
               RowBox[{"y", "\[GreaterEqual]", "0.5`"}]}]},
             {"1", 
              RowBox[{
               RowBox[{"0.2`", "<", "x", "<", "0.5`"}], "&&", 
               RowBox[{"0.3`", "<", "y", "<", "0.5`"}]}]},
             {"0", 
              TagBox["True",
               "PiecewiseDefault",
               AutoDelete->True]}
            },
            AllowedDimensions->{2, Automatic},
            Editable->True,
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}},
            Selectable->True]}
         },
         GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
         GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.35]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        "Piecewise",
        DeleteWithContents->True,
        Editable->False,
        SelectWithContents->True,
        Selectable->False,
        StripWrapperBoxes->True], ")"}], "-", 
      RowBox[{"(", 
       TagBox[GridBox[{
          {"\[Piecewise]", GridBox[{
             {"0", 
              RowBox[{
               RowBox[{"0.6`", "<", "x", "<", "0.8`"}], "&&", 
               RowBox[{"y", "\[GreaterEqual]", "0.5`"}]}]},
             {"1", 
              RowBox[{
               RowBox[{"0.6`", "<", "x", "<", "0.8`"}], "&&", 
               RowBox[{"0.1`", "<", "y", "<", "0.5`"}]}]},
             {"0", 
              TagBox["True",
               "PiecewiseDefault",
               AutoDelete->True]}
            },
            AllowedDimensions->{2, Automatic},
            Editable->True,
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}},
            Selectable->True]}
         },
         GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
         GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.35]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}],
        "Piecewise",
        DeleteWithContents->True,
        Editable->False,
        SelectWithContents->True,
        Selectable->False,
        StripWrapperBoxes->True], ")"}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9108293426266737`*^9, 3.9108294534176683`*^9}, 
   3.9108307517261133`*^9, 3.9108308023380547`*^9},
 CellLabel->
  "In[103]:=",ExpressionUUID->"157a949d-8a09-4105-ac87-d3cf8b4c9cb2"]
}, Open  ]]
},
WindowSize->{825.75, 624.75},
WindowMargins->{{81, Automatic}, {Automatic, 52.5}},
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"398b5b45-1f03-4dd4-9702-d63449e45b32"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 157, 3, 67, "Section",ExpressionUUID->"d0570329-f513-4c93-979d-6f0ffa0106ef"],
Cell[740, 27, 2170, 58, 181, "Input",ExpressionUUID->"4bcda9e4-6467-463a-8545-a5cfc9ee08d4"],
Cell[2913, 87, 1896, 52, 181, "Input",ExpressionUUID->"2a7cb272-9e45-4350-ad9e-e4f54443b43d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4846, 144, 162, 3, 67, "Section",ExpressionUUID->"0ae9112f-6515-4c78-a437-fb960f71a99b"],
Cell[5011, 149, 1400, 42, 162, "Input",ExpressionUUID->"dec1aa7e-e3be-4d19-83ce-bd56c4266058"],
Cell[6414, 193, 2118, 52, 200, "Input",ExpressionUUID->"ba8dc4c8-c204-4cfc-b176-6eb29dab542f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8569, 250, 186, 3, 67, "Section",ExpressionUUID->"59891bc8-92a3-45ca-9929-6acc3a769e01"],
Cell[8758, 255, 3121, 74, 162, "Input",ExpressionUUID->"3a135901-17f9-40f4-868b-80536c8495c7"],
Cell[11882, 331, 2167, 52, 181, "Input",ExpressionUUID->"6e635659-aa74-440f-a8f5-81aa9fe161d7"],
Cell[CellGroupData[{
Cell[14074, 387, 1210, 32, 124, "Input",ExpressionUUID->"ccc8bfa3-939b-49c5-a5d9-55208fb57b4e"],
Cell[15287, 421, 5104, 139, 124, "Output",ExpressionUUID->"a987a9e8-3f44-4063-bab2-ee50fc304aa7"]
}, Open  ]],
Cell[20406, 563, 5587, 145, 170, "Input",ExpressionUUID->"157a949d-8a09-4105-ac87-d3cf8b4c9cb2"]
}, Open  ]]
}
]
*)

